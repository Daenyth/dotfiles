#!/bin/bash

# vim: fdm=marker ts=8 et:
####
# Modified from tldp.org by Daenyth
##

usecolorprompt=1

# ssh_conn() -- return 1 if connected locally, 0 otherwise {{{
function ssh_conn() {
	if [[ -n "$SSH_CLIENT"  ||  -n "$SSH2_CLIENT" ]]; then
	  echo "$red"
	fi
	echo "$blue"
}
# }}}

# root_privs() -- return 1 if not root, 0 if root {{{
function root_privs() {
	PRIV=1
	if [ `/usr/bin/id -u` -eq 0 ]; then
		PRIV=0
	fi
	return $PRIV
}
# }}}

if root_privs ; then
  USRHILIGHT="$red"
  PWDHILIGHT="$NC"
else
  PWDHILIGHT="$GREEN"
  USRHILIGHT="$cyan"
fi

colorprompt="\u$(ssh_conn)@${NC}\h ${PWDHILIGHT}\W${NC} ${USRHILIGHT}\\\$${NC} "
nocolorprompt="\u@\h \W \\\$ "

# Prompt shamelessly stolen from http://bbs.archlinux.org/viewtopic.php?pid=514024#p514024
#PROMPT_COMMAND='DIR=`pwd|sed -e "s!$HOME!~!"`; if [ ${#DIR} -gt 30 ]; then CurDir=${DIR:0:12}...${DIR:${#DIR}-15}; else CurDir=$DIR; fi'
#PS1="\n╔═[\[\033[01;36m\]\A\[\033[01;00m\]]═[\[\033[01;32m\]\u\[\033[01;33m\]@\[\033[01;31m\]\h\[\033[01;00m\]]\n\[\033[01;00m\]╚═══\[\033[00;32m\]=\[\033[00;33m\]=\[\033[00;31m\]=\[\033[01;00m\]═══[\[\033[01;36m\]\$CurDir\[\033[01;00m\]]\[\033[01;32m\]>>\[\033[00m\] "

if [ $usecolorprompt -eq 1 ]; then
	PS1="$colorprompt"
else
	PS1="$nocolorprompt"
fi

unset usecolorprompt
unset -f ssh_conn
unset -f root_privs
export PS1
